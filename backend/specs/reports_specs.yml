tags:
  - Reports
summary: Download CSV report for a scan
description: Generates and downloads a CSV report for the specified scan ID. Optional email delivery. Requires JWT.
produces:
  - text/csv
parameters:
  - name: scan_id
    in: path
    type: integer
    required: true
    description: ID of the scan to report
  - name: email
    in: query
    type: boolean
    required: false
    description: "If true, emails the CSV to user (default: false)"
security:
  - Bearer: []
responses:
  200:
    description: CSV report downloaded successfully
    headers:
      Content-Disposition:
        type: string
        description: Attachment filename (e.g., report_scan_{scan_id}.csv)
    schema:
      type: string
      format: binary
  403:
    description: Forbidden (not owner or admin)
    schema:
      type: object
      properties:
        error:
          type: string
  404:
    description: Scan not found
    schema:
      type: object
      properties:
        error:
          type: string
  500:
    description: Server error
    schema:
      type: object
      properties:
        error:
          type: string